/**
* Generated By NPCScript :: A scripting engine created for RSCEmulation by Zilent
*/
package org.rscemulation.server.npchandler.Tutorial_Island;
import org.rscemulation.server.event.DelayedQuestChat;
import org.rscemulation.server.model.InvItem;
import org.rscemulation.server.model.Npc;
import org.rscemulation.server.model.Player;
import org.rscemulation.server.model.Quest;
import org.rscemulation.server.model.World;
import org.rscemulation.server.npchandler.NpcHandler;
public class Fishing_Instructor implements NpcHandler {
	public void handleNpc(final Npc npc, final Player owner) throws Exception {
		npc.blockedBy(owner);
		owner.setBusy(true);
		Quest q = owner.getQuest(100);
		if(q != null) {
			switch(q.getStage()) {
				case 10:
					fishChatA(npc, owner);
					break;
				case 11:
					fishChatB(npc, owner, true);
					break;
				default:
					fishChatB(npc, owner, false);
			}
		}
	}
	
	private void fishChatA(final Npc npc, final Player owner) {
		if(owner.getInventory().countId(376) == 0) {
			ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(owner, npc, new String[] {"Hi are you here to tell me how to catch fish?"}, true) {
				public void finished() {
					ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Yes that's right, you're a smart one", "Fishing is a useful skill", "You can sell high level fish for lots of money", "Or of course you can cook it and eat it to heal yourself", "Unfortunately you'll have to start off catching shrimps", "Till your fishing level gets higher", "You'll need this"}) {
						public void finished() {
							owner.getActionSender().sendMessage("The fishing instructor gives you a somewhat old looking net");
							owner.getInventory().add(new InvItem(376, 1));
							ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Go catch some shrimp", "left click on that sparkling piece of water", "While you have the net in your inventory you might catch some fish"}) {
								public void finished() {
									owner.setBusy(false);
									npc.unblock();
								}
							});
						}
					});
				}
			});
		} else {
			ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Go catch some shrimp", "left click on that sparkling piece of water", "While you have the net in your inventory you might catch some fish"}) {
				public void finished() {
					owner.setBusy(false);
					npc.unblock();
				}
			});
		}
	}
	
	private void fishChatB(final Npc npc, final Player owner, final boolean incStage) {
		ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Well done you can now continue with the tutorial", "First you can cook the shrimps on my fire here if you like"}, true) {
			public void finished() {
				if(incStage)
					owner.incQuestCompletionStage(100);
				owner.setBusy(false);
				npc.unblock();
			}
		});
	}
}
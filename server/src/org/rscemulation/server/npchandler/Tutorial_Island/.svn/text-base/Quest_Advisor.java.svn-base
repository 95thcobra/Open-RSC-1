/**
* Generated By NPCScript :: A scripting engine created for RSCEmulation by Zilent
*/
package org.rscemulation.server.npchandler.Tutorial_Island;
import org.rscemulation.server.event.DelayedQuestChat;
import org.rscemulation.server.event.SingleEvent;
import org.rscemulation.server.model.ChatMessage;
import org.rscemulation.server.model.MenuHandler;
import org.rscemulation.server.model.Npc;
import org.rscemulation.server.model.Player;
import org.rscemulation.server.model.Quest;
import org.rscemulation.server.model.World;
import org.rscemulation.server.npchandler.NpcHandler;
public class Quest_Advisor implements NpcHandler {
	public void handleNpc(final Npc npc, final Player owner) throws Exception {
		npc.blockedBy(owner);
		owner.setBusy(true);
		Quest q = owner.getQuest(100);
		if(q != null) {
			switch(q.getStage()) {
				case 16:
					questChat(npc, owner, true);
				default:
					questChat(npc, owner, false);
			}
		}
	}
	
	private void questChat(final Npc npc, final Player owner, final boolean incStage) {
		ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Greetings traveller", "If you're interested in a bit of adventure", "I can recommend going on a good quest", "There are many secrets to be uncovered", "And wrongs to be set right", "If you talk to the various characters in tha game", "some of them will give you quests"}, true) {
			public void finished() {
				ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(owner, npc, new String[] {"What sort of quests are there to do?"}) {
					public void finished() {
						ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"If you select the bar graph in the menu bar", "and then select the quests tab", "You will see a list of quests", "quests you have completed will show up in green", "You can only do each quest once"}) {
							public void finished() {
								ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new SingleEvent(owner, 1500) {
									public void action() {
										final String[] options0 = {"Thank you for the advice", "Can you recommend any quests?"};
										owner.setBusy(false);
										owner.getActionSender().sendMenu(options0);
										owner.setMenuHandler(new MenuHandler(options0) {
											public void handleReply(final int option, final String reply) {
												owner.setBusy(true);
												for(Player informee : owner.getViewArea().getPlayersInView()) {
													informee.informOfChatMessage(new ChatMessage(owner, reply, npc));
												}
												switch(option) {
													case 0:
														thanks(npc, owner);
														break;
													case 1:
														ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"----------------------------------"}) {
															public void finished() {
																owner.incQuestCompletionStage(100);
																owner.setBusy(false);
																npc.unblock();
															}
														});
														break;
												}
											}
										});
									}
								});
							}
						});
					}
				});
			}
		});
	}
	private void thanks(final Npc npc, final Player owner) {
		ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"good questing traveller"}) {
			public void finished() {
				owner.incQuestCompletionStage(100);
				owner.setBusy(false);
				npc.unblock();
			}
		});
	}
}
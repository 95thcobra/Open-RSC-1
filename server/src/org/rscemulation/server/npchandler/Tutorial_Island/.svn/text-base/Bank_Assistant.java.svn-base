/**
* Generated By NPCScript :: A scripting engine created for RSCEmulation by Zilent
*/
package org.rscemulation.server.npchandler.Tutorial_Island;
import org.rscemulation.server.event.DelayedQuestChat;
import org.rscemulation.server.event.SingleEvent;
import org.rscemulation.server.model.ChatMessage;
import org.rscemulation.server.model.MenuHandler;
import org.rscemulation.server.model.Npc;
import org.rscemulation.server.model.Player;
import org.rscemulation.server.model.Quest;
import org.rscemulation.server.model.World;
import org.rscemulation.server.npchandler.NpcHandler;
public class Bank_Assistant implements NpcHandler {
	public void handleNpc(final Npc npc, final Player owner) throws Exception {
		npc.blockedBy(owner);
		owner.setBusy(true);
		Quest q = owner.getQuest(100);
		if(q != null) {
			switch(q.getStage()) {
				case 15:
					bankChatA(npc, owner);
					break;
				case 16:
					bankChatB(npc, owner);
			}
		}
	}
	
	private void bankChatA(final Npc npc, final Player owner) {
		ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Hello welcome to the bank of runescape", "You can deposit your items in banks", "This allows you to own much more equipment", "than can be fitted in your inventory", "It will also keep your items safe", "So you won't lose them when you die", "You can withdraw deposited items from any bank in the world"}, true) {
			public void finished() {
				ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(owner, npc, new String[] {"Can I access my bank account please?"}) {
					public void finished() {
						ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Certainly Sir"}) {
							public void finished() {
								owner.incQuestCompletionStage(100);
								owner.setBusy(false);
								npc.unblock();
							}
						});
					}
				});
			}
		});
	}
	
	private void bankChatB(final Npc npc, final Player owner) {
		ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Hello welcome to the bank of runescape", "You can deposit your items in banks", "This allows you to own much more equipment", "than can be fitted in your inventory", "It will also keep your items safe", "So you won't lose them when you die", "You can withdraw deposited items from any bank in the world", "Now proceed through the next door"}, true) {
			public void finished() {
				ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new SingleEvent(owner, 1500) {
					public void action() {
						final String[] options0 = {"Can I access my bank account please?", "Okay thank you for your help"};
						owner.setBusy(false);
						owner.getActionSender().sendMenu(options0);
						owner.setMenuHandler(new MenuHandler(options0) {
							public void handleReply(final int option, final String reply) {
								owner.setBusy(true);
								for(Player informee : owner.getViewArea().getPlayersInView()) {
									informee.informOfChatMessage(new ChatMessage(owner, reply, npc));
								}
								switch(option) {
									case 0:
										accessPlease(npc, owner);
										break;
									case 1:
										thankYou(npc, owner);
										break;
								}
							}
						});
					}
				});
			}
		});
	}

	private void thankYou(final Npc npc, final Player owner) {
		ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Not a problem"}) {
			public void finished() {
				owner.setBusy(false);
				npc.unblock();
			}
		});
	}
	
	private void accessPlease(final Npc npc, final Player owner) {
		ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Certainly Sir"}) {
			public void finished() {
				owner.setBusy(false);
				npc.unblock();
			}
		});
	}
}
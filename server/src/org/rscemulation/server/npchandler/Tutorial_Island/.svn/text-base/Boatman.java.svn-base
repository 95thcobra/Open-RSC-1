/**
* Generated By NPCScript :: A scripting engine created for RSCEmulation by Zilent
*/
package org.rscemulation.server.npchandler.Tutorial_Island;
import org.rscemulation.server.event.DelayedQuestChat;
import org.rscemulation.server.event.SingleEvent;
import org.rscemulation.server.model.ChatMessage;
import org.rscemulation.server.model.MenuHandler;
import org.rscemulation.server.model.Npc;
import org.rscemulation.server.model.Player;
import org.rscemulation.server.model.World;
import org.rscemulation.server.npchandler.NpcHandler;
public class Boatman implements NpcHandler {
	public void handleNpc(final Npc npc, final Player owner) throws Exception {
		npc.blockedBy(owner);
		owner.setBusy(true);
		ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Hello my job is to take you to the main game area", "It's only a short row", "I shall take you to the small town of Lumbridge", "in the kingdom of Misthalin"}, true) {
			public void finished() {
				ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new SingleEvent(owner, 1500) {
					public void action() {
						final String[] options0 = {"Ok I'm ready to go", "I'm not done here yet"};
						owner.setBusy(false);
						owner.getActionSender().sendMenu(options0);
						owner.setMenuHandler(new MenuHandler(options0) {
							public void handleReply(final int option, final String reply) {
								owner.setBusy(true);
								for(Player informee : owner.getViewArea().getPlayersInView()) {
									informee.informOfChatMessage(new ChatMessage(owner, reply, npc));
								}
								switch(option) {
									case 0:
										readyGo(npc, owner);
										break;
									case 1:
										notDone(npc, owner);
										break;
								}
							}
						});
					}
				});
			}
		});
	}

	private void readyGo(final Npc npc, final Player owner) {
		ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Let's go then"}) {
			public void finished() {
				owner.finishQuest(100);
				owner.getActionSender().sendMessage("You have completed the tutorial");
				owner.teleport(122, 647, false);
				owner.setBusy(false);
				npc.unblock();
			}
		});
	}

	private void notDone(final Npc npc, final Player owner) {
		ServerBootstrap.getDefaultInstance().getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Speak to me again when you are ready to leave"}) {
			public void finished() {
				owner.setBusy(false);
				npc.unblock();
			}
		});
	}
}